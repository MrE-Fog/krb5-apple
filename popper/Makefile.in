#
# Compile options:
# -DMMDF : Use for MMDF style mail drops
# -DKPOP_SERVICE : define the name of service (defaults to kpop)
# -DPOP_PVT_PASSWD : use a private passwd file for users of the POP mail service
# -DMAILDIR : Set to site specific other than default.
#
CFLAGS = $(CCOPTS) -DMAILDIR=\"/usr/spool/pop\" -DKERBEROS -DKRB5 -DDEBUG $(DEFS) $(LOCALINCLUDE)

KRB5MANROOT = $(KRB5ROOT)/man
ADMIN_BINDIR = $(KRB5ROOT)/admin
SERVER_BINDIR = $(KRB5ROOT)/sbin
CLIENT_BINDIR = $(KRB5ROOT)/bin
SERVER_MANSUFFIX = 8
ADMIN_MANDIR = $(KRB5MANROOT)/man$(SERVER_MANSUFFIX)
SERVER_MANDIR = $(KRB5MANROOT)/man$(SERVER_MANSUFFIX)
SERVER_MANDIR = $(KRB5MANROOT)/man8
CLIENT_MANDIR = $(KRB5MANROOT)/man1
FILE_MANDIR = $(KRB5MANROOT)/man5
KRB5_LIBDIR = $(KRB5ROOT)/lib
KRB5_INCDIR = $(KRB5ROOT)/include
KRB5_INCSUBDIRS = \
	$(KRB5_INCDIR)/krb5 \
	$(KRB5_INCDIR)/asn.1 \
	$(KRB5_INCDIR)/kerberosIV

SRCTOP = $(srcdir)/$(BUILDTOP)
TOPLIBD = $(BUILDTOP)/lib
COMERRLIB=$(BUILDTOP)/util/et/libcom_err.a
DBMLIB=

all::

KLIB = $(TOPLIBD)/libkrb5.a $(TOPLIBD)/libcrypto.a $(COMERRLIB) $(DBMLIB)
DEPKLIB = $(TOPLIBD)/libkrb5.a $(TOPLIBD)/libcrypto.a $(COMERRLIB) $(DBMLIB)

OBJS		=	pop_dele.o pop_dropcopy.o pop_dropinfo.o \
			pop_get_command.o pop_get_subcommand.o pop_init.o \
			pop_last.o pop_list.o pop_log.o pop_lower.o \
			pop_msg.o pop_parse.o pop_pass.o pop_quit.o \
			pop_rset.o pop_send.o pop_stat.o pop_updt.o \
			pop_user.o pop_xtnd.o pop_xmit.o popper.o

popper: $(OBJS) $(DEPKLIB)
	$(CC) $(CFLAGS) -o popper $(OBJS) $(KLIB) $(LIBS)

all:: popper

$(OBJS): popper.h
pop_dele.o: $(srcdir)/pop_dele.c
pop_dropcopy.o: $(srcdir)/pop_dropcopy.c
pop_dropinfo.o: $(srcdir)/pop_dropinfo.c
pop_enter.o: $(srcdir)/pop_enter.c
pop_get_command.o: $(srcdir)/pop_get_command.c
pop_get_subcommand.o: $(srcdir)/pop_get_subcommand.c
pop_init.o: $(srcdir)/pop_init.c
pop_last.o: $(srcdir)/pop_last.c
pop_list.o: $(srcdir)/pop_list.c
pop_log.o: $(srcdir)/pop_log.c
pop_lower.o: $(srcdir)/pop_lower.c
pop_msg.o: $(srcdir)/pop_msg.c
pop_parse.o: $(srcdir)/pop_parse.c
pop_pass.o: $(srcdir)/pop_pass.c
pop_quit.o: $(srcdir)/pop_quit.c
pop_rset.o: $(srcdir)/pop_rset.c
pop_send.o: $(srcdir)/pop_send.c
pop_stat.o: $(srcdir)/pop_stat.c
pop_updt.o: $(srcdir)/pop_updt.c
pop_user.o: $(srcdir)/pop_user.c
pop_xmit.o: $(srcdir)/pop_xmit.c
pop_xtnd.o: $(srcdir)/pop_xtnd.c
popper.o: $(srcdir)/popper.c

clean::
	$(RM) popper

install::
	$(INSTALL_PROGRAM) popper ${DESTDIR}$(SERVER_BINDIR)/popper
	$(INSTALL_DATA) $(srcdir)/popper.M ${DESTDIR}$(SERVER_MANDIR)/popper.$(SERVER_MANSUFFIX)
