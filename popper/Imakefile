#	$Source$
#	$Author$
#	$Id$
#
#  Copyright 1991 by the Massachusetts Institute of Technology.
#  All Rights Reserved.
# 
# Export of this software from the United States of America may
#   require a specific license from the United States Government.
#   It is the responsibility of any person or organization contemplating
#   export to obtain such a license before exporting.
# 
# WITHIN THAT CONSTRAINT, permission to use, copy, modify, and
# distribute this software and its documentation for any purpose and
# without fee is hereby granted, provided that the above copyright
# notice appear in all copies and that both that copyright notice and
# this permission notice appear in supporting documentation, and that
# the name of M.I.T. not be used in advertising or publicity pertaining
# to distribution of the software without specific, written prior
# permission.  M.I.T. makes no representations about the suitability of
# this software for any purpose.  It is provided "as is" without express
# or implied warranty.
# 
# 

#               Options are:
#               BIND43          -	If you are using BSD 4.3 domain
#					name service.
#		DEBUG		-	Include the debugging code.  Note:  You
#					still have to use the -d or -t flag to
#					enable debugging.
#               HAVE_VSPRINTF   -	If the vsprintf functions are
#					available 
#					on your system.
#               SYSLOG42        -	For BSD 4.2 syslog (default is BSD 4.3 
#					syslog).
#               STRNCASECMP     -	If you do not have strncasecmp()
#		KERBEROS  	-       If you want authentication vis Kerberos
#									(tom)
#		KERBEROS_PASSWD_HACK -  Use popper as passwd server
#		NOSTATUS	-	Don't create a Mail(1)-like
#					Status: header

#if defined(OS_BSD_RENO) || defined(OS_Ultrix) || defined(OS_SunOS4) || defined(OS_BSD)
BINDDEF=-DBIND43
#else
/* assume it's not there; not really critical since we are using Kerberos to
   beef up the normal IP-address checking stuff */
BINDDEF=
#endif

#if 0

/* Zephyr stuff not needed yet, since spop isn't done yet. */
DEFINES = -DHAVE_VSPRINTF -DKERBEROS -DKRB5 -DNOSTATUS -DDEBUG $(BINDDEF) $(ZEPHDEFS)
LOCAL_LIBRARIES = $(ZEPHLIBS) $(KLIB)
DEP_LIBS= $(ZEPHDEPLIB) $(DEPKLIB)

#else

DEFINES = -DHAVE_VSPRINTF -DKERBEROS -DKRB5 -DNOSTATUS -DDEBUG $(BINDDEF)
LOCAL_LIBRARIES = $(KLIB)
DEP_LIBS= $(DEPKLIB)

#endif
OBJS		=	pop_dele.o pop_dropcopy.o pop_dropinfo.o \
			pop_get_command.o pop_get_subcommand.o pop_init.o \
			pop_last.o pop_list.o pop_log.o pop_lower.o \
			pop_msg.o pop_parse.o pop_pass.o pop_quit.o \
			pop_rset.o pop_send.o pop_stat.o pop_updt.o \
			pop_user.o pop_xtnd.o pop_xmit.o popper.o
SRCS		=	pop_dele.c pop_dropcopy.c pop_dropinfo.c \
			pop_get_command.c pop_get_subcommand.c pop_init.c \
			pop_last.c pop_list.c pop_log.c pop_lower.c \
			pop_msg.c pop_parse.c pop_pass.c pop_quit.c \
			pop_rset.c pop_send.c pop_stat.c pop_updt.c \
			pop_user.c pop_xtnd.c pop_xmit.c popper.c $(SPOP_SRCS)
#if 0
SPOP_OBJS	=	pop_enter.o
SPOP_SRCS	=	pop_enter.c
#endif

all:: popper

NormalProgramTarget(popper,$(OBJS),$(DEP_LIBS),$(LOCAL_LIBRARIES),)
Krb5InstallServerProgram(popper)

#if 0
NormalProgramTarget(spop,$(SPOP_OBJS),$(DEP_LIBS),$(LOCAL_LIBRARIES),)
Krb5InstallServerProgram(spop)
#endif

DependTarget()
