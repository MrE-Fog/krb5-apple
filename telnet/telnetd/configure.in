AC_INIT(telnetd.c)
WITH_CCOPTS
WITH_KRB5ROOT
ISODE_DEFS
ISODE_INCLUDE
CONFIG_RULES
AC_SET_BUILDTOP
AC_PROG_INSTALL
KRB_INCLUDE
WITH_KRB4
AC_ARG_WITH([krb4],,dnl
ADD_DEF(-DKRB4)
K4LIB='$(KRB4)/lib/libkrb.a $(KRB4)/lib/libdes.a',
K4LIB=)
AC_SUBST(K4LIB)
ISODE_INCLUDE
AC_CHECK_LIB(ndbm,main)
AC_CHECK_LIB(socket,main)
AC_CHECK_LIB(nsl,main)
AC_CHECK_LIB(dbm,main)
AC_CHECK_LIB(util,main)
AC_CHECK_LIB(termcap,main,AC_DEFINE(TERMCAP)
LIBS="$LIBS -ltermcap")
AC_HEADER_CHECK(termios.h,AC_DEFINE(USE_TERMIO) ac_termio=1)
if test -z "$ac_termio"; then
AC_HEADER_CHECK(termio.h,AC_DEFINE(SYSV_TERMIO),ac_sysv_termio=1)
if test -z "$ac_sysv_termio"; then
  AC_MSG_CHECKING([for cc_t in termio.h])
  AC_CACHE_VAL(krb_cv_type_cc_t,
  [AC_TRY_LINK([cc_t],[#include <termio.h>],
  [cc_t foo;],krb_cv_type_cc_t=yes,krb_cv_type_cc_t=no)])
  AC_MSG_RESULT($krb_cv_type_cc_t)
  if test $krb_cv_type_cc_t = no; then
    AC_DEFINE(NO_CC_T)
  fi
fi
fi
AC_HEADER_TIME
AC_CHECK_HEADERS(sys/time.h sys/tty.h)
AC_HAVE_FUNCS(vhangup)
AC_FUNC_CHECK(grantpt,AC_DEFINE(STREAMSPTY))
AC_FUNC_CHECK(gettosbyname,AC_DEFINE(HAS_GETTOS))
AC_HEADER_CHECK(sys/filio.h,AC_DEFINE(FILIO_H))
AC_HEADER_CHECK(sys/stream.h,AC_DEFINE(STREAMS))
AC_HEADER_CHECK(utmpx.h,AC_DEFINE(UTMPX))
AC_FUNC_CHECK(cgetent,AC_DEFINE(HAS_CGETENT))
AC_MSG_CHECKING([if setpgrp takes two arguments])
dnl
AC_CACHE_VAL(krb5_cv_sys_setpgrp_two,
[AC_TRY_LINK( 
[#include <unistd.h>],[setpgrp(0,0)],
krb5_cv_sys_setpgrp_two=yes,krb5_cv_sys_setpgrp_two=no)])
AC_MSG_RESULT($krb5_cv_sys_setpgrp_two)
if test $krb5_cv_sys_setpgrp_two = yes; then
  AC_DEFINE(SETPGRP_TWOARG)
fi
V5_AC_OUTPUT_MAKEFILE
